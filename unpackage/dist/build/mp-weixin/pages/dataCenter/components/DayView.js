"use strict";const e=require("../../../common/vendor.js"),a=require("../../../utils/require.js"),t=require("./format.js");if(require("../../../config.js"),!Array){e.resolveComponent("uni-calendar")()}Math;const r={__name:"DayView",props:{initialDate:{type:String,default:()=>t.formatDate(new Date)}},setup(r){const o=r,n=e.ref(o.initialDate),l=e.ref(null),i=e.ref([]),u=async(e,t)=>{var r;try{const o=await a.request({url:`/swimming/month-record-dates?year=${e}&month=${t}`,method:"GET"});if(200===(null==(r=o.data)?void 0:r.code)){const e=o.data.data.map((e=>({date:e})));i.value=e}else i.value=[]}catch(o){console.error("获取月度记录失败",o),i.value=[]}},s=async e=>{var t,r;try{const o=await a.request({url:"/swimming/date-record",method:"GET",data:{date:e}});200===(null==(t=o.data)?void 0:t.code)?l.value=o.data.data:(l.value=null,console.warn("获取日期记录失败:",null==(r=o.data)?void 0:r.message))}catch(o){console.error("获取日期记录失败:",o),l.value=null}},c=e=>{if(null==e?void 0:e.fulldate)try{const a=new Date(e.fulldate);if(isNaN(a.getTime()))return void console.error("Invalid date:",e.fulldate);const r=t.formatDate(a);n.value=r,s(r)}catch(a){console.error("日期处理错误:",a)}},d=e=>{if((null==e?void 0:e.year)&&(null==e?void 0:e.month))try{const a=parseInt(e.year),t=parseInt(e.month);if(isNaN(a)||isNaN(t)||t<1||t>12)return void console.error("Invalid year or month:",e);u(a,t)}catch(a){console.error("月份切换处理错误:",a)}};return e.onMounted((()=>{try{const e=new Date(n.value);if(isNaN(e.getTime()))return void console.error("Invalid initial date:",n.value);const a=e.getFullYear(),t=e.getMonth()+1;u(a,t),s(n.value)}catch(e){console.error("初始化错误:",e)}})),(a,r)=>e.e({a:e.o(c),b:e.o(d),c:e.p({insert:!0,selected:i.value,date:n.value,showMonth:!1}),d:l.value},l.value?{e:e.t(l.value.distance||0),f:e.t(e.unref(t.formatDuration)(l.value.duration)),g:e.t(e.unref(t.formatPace)(l.value.averagePace)),h:e.t(l.value.calories||0),i:e.t(l.value.poolLength||0),j:e.t(l.value.laps||0)}:{})}},o=e._export_sfc(r,[["__scopeId","data-v-b97bd4e7"]]);wx.createComponent(o);
