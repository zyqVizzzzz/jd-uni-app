"use strict";const t=require("../../common/vendor.js"),e=require("../../utils/require.js");require("../../config.js"),Math||a();const a=()=>"../../components/LoginPopup.js",r={__name:"data",setup(a){const r=t.ref(null),o=t.ref({}),n=t.ref({}),l=t.ref({currentDistance:0,targetDistance:2e3,completionRate:0}),s=t.ref((new Date).getMonth()+1),c=t=>{if(!t)return"0";return`${Math.floor(t/60)}'${(t%60).toString().padStart(2,"0")}"`},u=t=>{if(!t)return"0";return`${Math.floor(t/60)}'${Math.floor(t%60).toString().padStart(2,"0")}″/100m`},i=t=>{if(!t)return"";const e=new Date(t);return`${e.getFullYear()}.${e.getMonth()+1}.${e.getDate()}`},d=t=>{if(!t)return 0;const e=Math.abs(new Date-new Date(t));return Math.ceil(e/864e5)},g=async()=>{try{const t=await e.request({url:"/swimming/latest"});200===t.data.code&&(o.value=t.data.data)}catch(t){console.error("获取最新记录失败",t)}},m=async()=>{const t=new Date;try{const a=await e.request({url:"/swimming/monthly-stats",params:{year:t.getFullYear(),month:t.getMonth()+1}});200===a.data.code&&(console.log(a.data.data),n.value=a.data.data[0]||{})}catch(a){console.error("获取月度统计失败",a)}},v=async()=>{const t=new Date;try{const a=await e.request({url:"/swimming/monthly-target",params:{year:t.getFullYear(),month:t.getMonth()+1}});200===a.data.code&&(l.value=a.data.data)}catch(a){console.error("获取月度目标失败",a)}},h=t.ref({totalDistance:0,totalDuration:0,totalCalories:0,recordCount:0}),w=async()=>{try{const t=await e.request({url:"/swimming/total-stats"});200===t.data.code&&(h.value=t.data.data)}catch(t){console.error("获取总计统计失败",t)}},p=()=>{t.index.navigateTo({url:"/pages/dataCenter/dataCenter"})},f=()=>{r.value.open()},y=async()=>{await Promise.all([g(),m(),v(),w()])},D=()=>{},M=async()=>{try{201===(await e.request({url:"/swimming/generate-mock",method:"POST"})).data.code&&y()}catch(t){return console.error("生成游泳记录失败",t),null}};return t.onMounted((()=>{(e=>{if(!t.index.getStorageSync("token"))return f(),!1;e()})((async()=>{await Promise.all([g(),m(),v(),w()])}))})),(e,a)=>({a:t.t(o.value.distance||0),b:t.t(c(o.value.duration)),c:t.t(u(o.value.averagePace)),d:t.t(o.value.calories||0),e:t.t(o.value.poolLength||0),f:t.t(o.value.strokes||0),g:t.o(p),h:t.t(i(o.value.date)),i:t.t(d(o.value.date)),j:t.t(h.value.totalDistance||0),k:t.t(c(h.value.totalDuration)),l:t.t(s.value),m:t.t(l.value.currentDistance),n:t.t(s.value),o:t.t((100*l.value.completionRate).toFixed(0)),p:100*l.value.completionRate+"%",q:t.t(l.value.currentDistance),r:t.t(l.value.targetDistance),s:t.o(M),t:t.sr(r,"b6e98cea-0",{k:"loginPopupRef"}),v:t.o(y),w:t.o(D)})}},o=t._export_sfc(r,[["__scopeId","data-v-b6e98cea"]]);wx.createPage(o);
