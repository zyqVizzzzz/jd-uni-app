"use strict";const t=require("../../common/vendor.js"),e=require("../../utils/require.js");require("../../config.js"),Math||a();const a=()=>"../../components/LoginPopup.js",r={__name:"data",setup(a){const r=t.ref(null),o=t.ref({});t.ref({});const n=t.ref({currentDistance:0,targetDistance:2e3,completionRate:0}),l=t.ref((new Date).getMonth()+1),u=t=>{if(!t)return"0";return`${Math.floor(t/60)}'${(t%60).toString().padStart(2,"0")}"`},c=t=>{if(!t)return"0";return`${Math.floor(t/60)}'${Math.floor(t%60).toString().padStart(2,"0")}″/100m`},s=t=>{if(!t)return"";const e=new Date(t);return`${e.getFullYear()}.${e.getMonth()+1}.${e.getDate()}`},i=t=>{if(!t)return 0;const e=Math.abs(new Date-new Date(t));return Math.ceil(e/864e5)},d=async()=>{try{const t=await e.request({url:"/swimming/latest"});200===t.data.code&&(o.value=t.data.data)}catch(t){console.error("获取最新记录失败",t)}},v=async()=>{try{const t=await e.request({url:"/swimming/monthly-target"});200===t.data.code&&(n.value=t.data.data||{},console.log(n.value))}catch(t){console.error("获取月度统计失败",t)}},g=t.ref({totalDistance:0,totalDuration:0,totalCalories:0,recordCount:0}),f=async()=>{try{const t=await e.request({url:"/swimming/total-stats"});200===t.data.code&&(g.value=t.data.data)}catch(t){console.error("获取总计统计失败",t)}},m=()=>{t.index.navigateTo({url:"/pages/dataCenter/dataCenter"})},p=()=>{r.value.open()},h=async()=>{await Promise.all([d(),v(),f()])},w=()=>{},D=async()=>{try{201===(await e.request({url:"/swimming/generate-mock",method:"POST"})).data.code&&h()}catch(t){return console.error("生成游泳记录失败",t),null}};return t.onMounted((()=>{(e=>{if(!t.index.getStorageSync("token"))return p(),!1;e()})((async()=>{await Promise.all([d(),v(),f()])}))})),(e,a)=>({a:t.t(o.value.distance||0),b:t.t(u(o.value.duration)),c:t.t(c(o.value.averagePace)),d:t.t(o.value.calories||0),e:t.t(o.value.poolLength||0),f:t.t(o.value.strokes||0),g:t.o(m),h:t.t(s(o.value.date)),i:t.t(i(o.value.date)),j:t.t(g.value.totalDistance||0),k:t.t(u(g.value.totalDuration)),l:t.t(l.value),m:t.t(n.value.currentDistance),n:t.t(l.value),o:t.t((100*n.value.completionRate).toFixed(0)),p:100*n.value.completionRate+"%",q:t.t(n.value.currentDistance),r:t.t(n.value.targetDistance),s:t.o(D),t:t.sr(r,"fe9ef3b2-0",{k:"loginPopupRef"}),v:t.o(h),w:t.o(w)})}},o=t._export_sfc(r,[["__scopeId","data-v-fe9ef3b2"]]);wx.createPage(o);
